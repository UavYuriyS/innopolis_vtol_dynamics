# Notation:
# We use FRD and NED notation and look on the vehicle from the above from tail to nose.
# The roll, pitch, and yaw directions adhere to the right-hand rule:
# Roll: Positive roll is clockwise when looking from the tail forward.
# Pitch: Positive pitch is nose-up (tail down), effectively clockwise when viewed from the side.
# Yaw: Positive yaw is clockwise when viewed from above the UAV.

# Reference: https://github.com/PX4/PX4-SITL_gazebo-classic/blob/main/models/standard_vtol/standard_vtol.sdf.jinja

sim:
  init_position: [55.75690, 48.74115, -7.8] # [lat (degree), lon (degree), alt (meters)]

  # Initial Yaw
  #   - 0 degrees yaw points towards North.
  #   - Yaw increases clockwise.
  #  (0 => North, -90 => East, -180 => South, -90 => West)
  init_yaw_deg: 45.0  # Initial yaw angle in degrees

  integration_frequency: 1000 # Hz

  connection-3d:
    mode: "server"       # Use "server" for standalone mode (no ROS needed), or "client" for integration with ROS.
    ip: "ws://localhost" # Only used in "client" mode: ROSBridge WebSocket server address.
    port: 9090           # Port for the connection: same for "server" or "client" mode.

environment:
  # This is the standard acceleration due to gravity on Earth's surface.
  # If you are simulating in a different planetary context or need slight
  # variations due to altitude changes, you might adjust it slightly.
  gravity: 9.80665  # m/s^2

  # This is the standard atmospheric density at sea level at 15Â°C under
  # International Standard Atmosphere (ISA) conditions. Atmospheric density
  # decreases with altitude, so if you are simulating high-altitude UAV
  # operations, you might use a lower value. For example:
  # At 5000 m altitude: ~0.736 kg/m^3
  # At 10,000 m altitude: ~0.413 kg/m^3
  air_density: 1.2  # air density (kg/m^3)

  wind_ned: [0.0, 0.0, 0.0]

vehicle:
  mass: 5.0 # kg
  inertia: [0.478, 0,     0,
            0,     0.342, 0,
            0,     0,     0.811] # kg*m^2
  center_of_gravity: [-0.15, 0.0, -0.05]
  lon_static_friction: 0.5
  lon_kinetic_friction: 0.4
  lat_static_friction: 0.8
  lat_kinetic_friction: 0.7

actuators:
  bldc_analytic_model:
    max_velocity: 1600.0 # rad/s
    max_thrust: 50.0
    max_torque: 0.7

  bldc_analytic_model2:
    max_velocity: 3500.0 # rad/s
    max_thrust: 120.0
    max_torque: 0.7

  airframe:
    - name: Channel 1 - Disabled
      type: motor
      position: [0, 0, 0]
      axis: [0, 0, 0]
      direction_ccw: True
      model: bldc_analytic_model

    - name: Channel 2 - Disabled
      type: motor
      position: [0, 0, 0]
      axis: [0, 0, 0]
      direction_ccw: True
      model: bldc_analytic_model

    - name: Channel 3 - Rudder
      type: servo
      cm: [0.00, 0.00, 1.15]
      time_constant: 0.01
      max_angle_deg: 20

    - name: Channel 4 - Left Flap
      type: motor
      position: [0, 0, 0]
      axis: [0, 0, 0]
      direction_ccw: True
      model: bldc_analytic_model

    - name: Channel 5 - Forward Pusher
      type: motor
      position: [0.20, 0.00, 0.00]
      axis: [1.0, 0.00, 0.00]
      direction_ccw: True
      model: bldc_analytic_model2

    - name: Channel 6 - Left Aileron
      type: servo
      cm: [-0.2, 0.00, 0.02]
      time_constant: 0.01
      max_angle_deg: 20

    - name: Channel 7 - Right Aileron
      type: servo
      cm: [+0.2, 0.00, -0.02]
      time_constant: 0.01
      max_angle_deg: 20

    - name: Channel 8 - Elevator
      type: servo
      cm: [0.00, 0.458, 0.00]
      time_constant: 0.01
      max_angle_deg: 20

    - name: Channel 9 - Right Flap Reverse
      type: motor
      position: [0, 0, 0]
      axis: [0, 0, 0]
      direction_ccw: True
      model: bldc_analytic_model

sensors:
  acc_variance:  0.0005
  gyro_variance: 0.0005

aerodynamics:

  # Reference Geometry
  # Used to convert dimensionless aerodynamic coefficients into physical forces and moments.
  reference_data:
    wing_area: 0.65     # Wing area [m^2]
    mean_chord: 0.25    # Mean aerodynamic chord [m]
    wing_span: 2.4      # Wingspan [m]

  # Baseline Aerodynamic Coefficients
  #
  # Divided into "longitudinal" (alpha-based) and "lateral" (beta-based) sections,
  # plus dynamic derivatives.
  # 
  # The 'independent_variables' define the breakpoints for interpolation:
  #  - alpha_deg or beta_deg (the angle)
  #  - speed_ms (the airspeed in m/s)
  #
  # The 'data' block provides 2D tables of aerodynamic coefficients, 
  # dimensioned as [nAngles x nSpeeds].


  baseline:

    # Longitudinal Data
    # Coefficients that vary with angle of attack (alpha_deg) and airspeed (speed_ms)
    longitudinal:
      independent_variables:
        # Angle of attack [deg]
        alpha_deg: [-90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -58, -56, -54, -52, -50, -48, -46, -44, -42, -40, -38, -36, -34, -32, -30, -28, -26, -24, -22, -20, -18, -16, -14, -12, -10, -8, -6, -4, -2,  0,  2,  4,  6,  8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90]
        # Aircraft speed relative to the air [m/s]
        speed_ms:
          - 1
          - 45        
      data:
        # CL: Lift coefficient table [speed_ms x alpha_deg]
        CL:
          - [-1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.6093, -1.5147, -1.2882, -1.0612, -0.8342, -0.6072, -0.3802, -0.1532, 0.0738, 0.3008, 0.5278, 0.7548, 0.9818, 1.2088, 1.4358, 1.6628, 1.8898, 2.1168, 2.3437, 2.5699, 2.7921, 2.9898, 3.0498, 2.5483, 1.3495, 0.6473, 0.4955, 0.4973, 0.5285, 0.5633, 0.5967, 0.6272, 0.6543, 0.6776, 0.6966, 0.7110, 0.7206, 0.7252, 0.7245, 0.7184, 0.7069, 0.6899, 0.6675, 0.6399, 0.6070, 0.5693, 0.5269, 0.5079, 0.5079, 0.5079, 0.5079, 0.5079, 0.5079, 0.5079, 0.5079, 0.5079]
          - [-1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.7393, -1.6371, -1.3922, -1.1470, -0.9016, -0.6563, -0.4109, -0.1656, 0.0797, 0.3251, 0.5704, 0.8158, 1.0611, 1.3065, 1.5518, 1.7971, 2.0425, 2.2878, 2.5330, 2.7775, 3.0176, 3.2313, 3.2961, 2.7542, 1.4585, 0.6996, 0.5355, 0.5375, 0.5711, 0.6088, 0.6449, 0.6779, 0.7072, 0.7323, 0.7528, 0.7685, 0.7788, 0.7838, 0.7830, 0.7764, 0.7640, 0.7456, 0.7215, 0.6915, 0.6561, 0.6153, 0.5694, 0.5489, 0.5489, 0.5489, 0.5489, 0.5489, 0.5489, 0.5489, 0.5489, 0.5489]

        # CD: Drag coefficient table [speed_ms x alpha_deg]
        CD:
          - [4.0683, 3.8843, 3.7046, 3.5292, 3.3582, 3.1916, 3.0294, 2.8715, 2.7180, 2.5688, 2.4241, 2.2836, 2.1476, 2.0159, 1.8886, 1.7656, 1.6470, 1.5327, 1.4229, 1.3174, 1.2162, 1.1194, 1.0270, 0.9390, 0.8553, 0.7760, 0.7010, 0.6304, 0.5642, 0.5023, 0.4448, 0.3917, 0.3429, 0.2985, 0.2585, 0.2228, 0.1915, 0.1645, 0.1419, 0.1237, 0.1099, 0.1004, 0.0952, 0.0945, 0.0981, 0.1060, 0.1184, 0.1351, 0.1561, 0.1816, 0.2113, 0.2455, 0.2840, 0.3269, 0.3741, 0.4257, 0.4817, 0.5420, 0.6067, 0.6758, 0.7492, 0.8270, 0.9092, 0.9957, 1.0866, 1.1819, 1.2815, 1.3855, 1.4938, 1.6065, 1.7236, 1.8450, 1.9708, 2.1010, 2.2355, 2.3744, 2.5177, 2.6653, 2.8173, 2.9737, 3.1344, 3.2995, 3.4689, 3.6427, 3.8209, 4.0034, 4.1903, 4.3816, 4.5772, 4.7772, 4.9816]
          - [4.3970, 4.1980, 4.0038, 3.8143, 3.6295, 3.4495, 3.2741, 3.1035, 2.9376, 2.7764, 2.6199, 2.4681, 2.3211, 2.1787, 2.0411, 1.9082, 1.7800, 1.6566, 1.5378, 1.4238, 1.3145, 1.2099, 1.1100, 1.0148, 0.9244, 0.8387, 0.7576, 0.6813, 0.6098, 0.5429, 0.4808, 0.4233, 0.3706, 0.3226, 0.2793, 0.2408, 0.2069, 0.1778, 0.1534, 0.1337, 0.1187, 0.1085, 0.1029, 0.1021, 0.1060, 0.1146, 0.1279, 0.1460, 0.1687, 0.1962, 0.2284, 0.2653, 0.3069, 0.3533, 0.4043, 0.4601, 0.5206, 0.5858, 0.6558, 0.7304, 0.8098, 0.8938, 0.9826, 1.0762, 1.1744, 1.2773, 1.3850, 1.4974, 1.6145, 1.7363, 1.8628, 1.9941, 2.1300, 2.2707, 2.4161, 2.5662, 2.7211, 2.8806, 3.0449, 3.2139, 3.3876, 3.5660, 3.7491, 3.9370, 4.1295, 4.3268, 4.5288, 4.7355, 4.9470, 5.1631, 5.3840]
        
        # Cm: Pitching moment coefficient table [speed_ms x alpha_deg]
        Cm:
          - [3.1979, 3.1240, 3.0480, 2.9702, 2.8911, 2.8110, 2.7304, 2.6495, 2.5687, 2.4884, 2.4088, 2.3302, 2.2529, 2.1772, 2.1033, 2.0313, 1.9616, 1.8942, 1.8293, 1.7671, 1.7076, 1.6510, 1.5973, 1.5465, 1.4987, 1.4539, 1.4121, 1.3733, 1.3373, 1.3041, 1.2736, 1.2458, 1.2204, 1.1973, 1.1765, 1.1576, 1.0923, 0.9574, 0.8182, 0.6751, 0.5284, 0.3781, 0.2246, 0.0681, -0.0912, -0.2531, -0.4173, -0.5837, -0.7520, -0.9220, -1.0934, -1.2661, -1.4397, -1.6140, -1.7884, -1.9604, -2.1171, -2.1869, -1.9052, -1.1927, -0.7991, -0.7534, -0.8064, -0.8808, -0.9610, -1.0439, -1.1288, -1.2157, -1.3043, -1.3948, -1.4871, -1.5813, -1.6774, -1.7757, -1.8763, -1.9793, -2.0851, -2.1938, -2.3057, -2.4211, -2.5402, -2.6634, -2.8008, -2.9494, -3.1020, -3.2582, -3.4179, -3.5806, -3.7462, -3.9143, -4.0844]
          - [3.4562, 3.3763, 3.2942, 3.2101, 3.1246, 3.0381, 2.9509, 2.8635, 2.7762, 2.6894, 2.6034, 2.5184, 2.4349, 2.3531, 2.2732, 2.1954, 2.1200, 2.0472, 1.9771, 1.9098, 1.8456, 1.7844, 1.7263, 1.6714, 1.6198, 1.5714, 1.5262, 1.4842, 1.4453, 1.4094, 1.3765, 1.3464, 1.3190, 1.2941, 1.2715, 1.2511, 1.1806, 1.0348, 0.8843, 0.7297, 0.5710, 0.4087, 0.2428, 0.0736, -0.0985, -0.2735, -0.4510, -0.6308, -0.8127, -0.9965, -1.1817, -1.3683, -1.5560, -1.7444, -1.9328, -2.1188, -2.2881, -2.3636, -2.0591, -1.2890, -0.8637, -0.8142, -0.8715, -0.9520, -1.0386, -1.1282, -1.2200, -1.3139, -1.4097, -1.5075, -1.6072, -1.7090, -1.8129, -1.9192, -2.0278, -2.1392, -2.2535, -2.3710, -2.4919, -2.6167, -2.7454, -2.8786, -3.0270, -3.1877, -3.3526, -3.5214, -3.6940, -3.8699, -4.0488, -4.2305, -4.4144]

    # Lateral Data
    # Coefficients that primarily depend on sideslip angle (beta_deg) and airspeed (speed_ms)
    lateral:
      independent_variables:
        # beta_deg: Sideslip angle [deg]
        beta_deg: [-90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -58, -56, -54, -52, -50, -48, -46, -44, -42, -40, -38, -36, -34, -32, -30, -28, -26, -24, -22, -20, -18, -16, -14, -12, -10, -8, -6, -4, -2,  0,  2,  4,  6,  8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90]
        # Aircraft speed relative to the air [m/s]
        speed_ms:
          - 1
          - 45
      data:
        # CY: Side force coefficient [speed_ms x beta_deg]
        CY:
          - [1.4509, 1.4186, 1.3864, 1.3541, 1.3219, 1.2897, 1.2574, 1.2252, 1.1929, 1.1607, 1.1284, 1.0962, 1.0640, 1.0317, 0.9995, 0.9672, 0.9350, 0.9028, 0.8705, 0.8383, 0.8060, 0.7738, 0.7415, 0.7093, 0.6771, 0.6448, 0.6126, 0.5803, 0.5481, 0.5159, 0.4836, 0.4514, 0.4191, 0.3869, 0.3547, 0.3224, 0.2902, 0.2579, 0.2257, 0.1934, 0.1612, 0.1290, 0.0967, 0.0645, 0.0322, 0.0000, -0.0322, -0.0645, -0.0967, -0.1290, -0.1612, -0.1934, -0.2257, -0.2579, -0.2902, -0.3224, -0.3547, -0.3869, -0.4191, -0.4514, -0.4836, -0.5159, -0.5481, -0.5803, -0.6126, -0.6448, -0.6771, -0.7093, -0.7415, -0.7738, -0.8060, -0.8383, -0.8705, -0.9028, -0.9350, -0.9672, -0.9995, -1.0317, -1.0640, -1.0962, -1.1284, -1.1607, -1.1929, -1.2252, -1.2574, -1.2897, -1.3219, -1.3541, -1.3864, -1.4186, -1.4509]
          - [1.5681, 1.5332, 1.4984, 1.4635, 1.4287, 1.3938, 1.3590, 1.3241, 1.2893, 1.2544, 1.2196, 1.1848, 1.1499, 1.1151, 1.0802, 1.0454, 1.0105, 0.9757, 0.9408, 0.9060, 0.8711, 0.8363, 0.8015, 0.7666, 0.7318, 0.6969, 0.6621, 0.6272, 0.5924, 0.5575, 0.5227, 0.4878, 0.4530, 0.4181, 0.3833, 0.3485, 0.3136, 0.2788, 0.2439, 0.2091, 0.1742, 0.1394, 0.1045, 0.0697, 0.0348, 0.0000, -0.0348, -0.0697, -0.1045, -0.1394, -0.1742, -0.2091, -0.2439, -0.2788, -0.3136, -0.3485, -0.3833, -0.4181, -0.4530, -0.4878, -0.5227, -0.5575, -0.5924, -0.6272, -0.6621, -0.6969, -0.7318, -0.7666, -0.8015, -0.8363, -0.8711, -0.9060, -0.9408, -0.9757, -1.0105, -1.0454, -1.0802, -1.1151, -1.1499, -1.1848, -1.2196, -1.2544, -1.2893, -1.3241, -1.3590, -1.3938, -1.4287, -1.4635, -1.4984, -1.5332, -1.5681]
        
        # Cl: Rolling moment coefficient [speed_ms x beta_deg]
        Cl:
          - [0.2079, 0.2033, 0.1986, 0.1940, 0.1894, 0.1848, 0.1802, 0.1755, 0.1709, 0.1663, 0.1617, 0.1571, 0.1524, 0.1478, 0.1432, 0.1386, 0.1340, 0.1293, 0.1247, 0.1201, 0.1155, 0.1109, 0.1063, 0.1016, 0.0970, 0.0924, 0.0878, 0.0832, 0.0785, 0.0739, 0.0693, 0.0647, 0.0601, 0.0554, 0.0508, 0.0462, 0.0416, 0.0370, 0.0323, 0.0277, 0.0231, 0.0185, 0.0139, 0.0092, 0.0046, 0.0000, -0.0046, -0.0092, -0.0139, -0.0185, -0.0231, -0.0277, -0.0323, -0.0370, -0.0416, -0.0462, -0.0508, -0.0554, -0.0601, -0.0647, -0.0693, -0.0739, -0.0785, -0.0832, -0.0878, -0.0924, -0.0970, -0.1016, -0.1063, -0.1109, -0.1155, -0.1201, -0.1247, -0.1293, -0.1340, -0.1386, -0.1432, -0.1478, -0.1524, -0.1571, -0.1617, -0.1663, -0.1709, -0.1755, -0.1802, -0.1848, -0.1894, -0.1940, -0.1986, -0.2033, -0.2079]
          - [0.2247, 0.2197, 0.2147, 0.2097, 0.2047, 0.1997, 0.1947, 0.1897, 0.1847, 0.1797, 0.1747, 0.1698, 0.1648, 0.1598, 0.1548, 0.1498, 0.1448, 0.1398, 0.1348, 0.1298, 0.1248, 0.1198, 0.1148, 0.1098, 0.1048, 0.0999, 0.0949, 0.0899, 0.0849, 0.0799, 0.0749, 0.0699, 0.0649, 0.0599, 0.0549, 0.0499, 0.0449, 0.0399, 0.0349, 0.0300, 0.0250, 0.0200, 0.0150, 0.0100, 0.0050, 0.0000, -0.0050, -0.0100, -0.0150, -0.0200, -0.0250, -0.0300, -0.0349, -0.0399, -0.0449, -0.0499, -0.0549, -0.0599, -0.0649, -0.0699, -0.0749, -0.0799, -0.0849, -0.0899, -0.0949, -0.0999, -0.1048, -0.1098, -0.1148, -0.1198, -0.1248, -0.1298, -0.1348, -0.1398, -0.1448, -0.1498, -0.1548, -0.1598, -0.1648, -0.1698, -0.1747, -0.1797, -0.1847, -0.1897, -0.1947, -0.1997, -0.2047, -0.2097, -0.2147, -0.2197, -0.2247]
        
        # Cn: Yawing moment coefficient [speed_ms x beta_deg]
        Cn:
          - [-0.4608, -0.4506, -0.4403, -0.4301, -0.4198, -0.4096, -0.3994, -0.3891, -0.3789, -0.3686, -0.3584, -0.3482, -0.3379, -0.3277, -0.3174, -0.3072, -0.2970, -0.2867, -0.2765, -0.2662, -0.2560, -0.2458, -0.2355, -0.2253, -0.2150, -0.2048, -0.1946, -0.1843, -0.1741, -0.1638, -0.1536, -0.1434, -0.1331, -0.1229, -0.1126, -0.1024, -0.0922, -0.0819, -0.0717, -0.0614, -0.0512, -0.0410, -0.0307, -0.0205, -0.0102, 0.0000, 0.0102, 0.0205, 0.0307, 0.0410, 0.0512, 0.0614, 0.0717, 0.0819, 0.0922, 0.1024, 0.1126, 0.1229, 0.1331, 0.1434, 0.1536, 0.1638, 0.1741, 0.1843, 0.1946, 0.2048, 0.2150, 0.2253, 0.2355, 0.2458, 0.2560, 0.2662, 0.2765, 0.2867, 0.2970, 0.3072, 0.3174, 0.3277, 0.3379, 0.3482, 0.3584, 0.3686, 0.3789, 0.3891, 0.3994, 0.4096, 0.4198, 0.4301, 0.4403, 0.4506, 0.4608]
          - [-0.4980, -0.4870, -0.4759, -0.4648, -0.4537, -0.4427, -0.4316, -0.4205, -0.4095, -0.3984, -0.3873, -0.3763, -0.3652, -0.3541, -0.3431, -0.3320, -0.3209, -0.3099, -0.2988, -0.2877, -0.2767, -0.2656, -0.2545, -0.2435, -0.2324, -0.2213, -0.2103, -0.1992, -0.1881, -0.1771, -0.1660, -0.1549, -0.1439, -0.1328, -0.1217, -0.1107, -0.0996, -0.0885, -0.0775, -0.0664, -0.0553, -0.0443, -0.0332, -0.0221, -0.0111, 0.0000, 0.0111, 0.0221, 0.0332, 0.0443, 0.0553, 0.0664, 0.0775, 0.0885, 0.0996, 0.1107, 0.1217, 0.1328, 0.1439, 0.1549, 0.1660, 0.1771, 0.1881, 0.1992, 0.2103, 0.2213, 0.2324, 0.2435, 0.2545, 0.2656, 0.2767, 0.2877, 0.2988, 0.3099, 0.3209, 0.3320, 0.3431, 0.3541, 0.3652, 0.3763, 0.3873, 0.3984, 0.4095, 0.4205, 0.4316, 0.4427, 0.4537, 0.4648, 0.4759, 0.4870, 0.4980]
    
    # Dynamic Derivatives
    # Terms that model aerodynamic damping from aircraft angular rates:
    dynamic_derivatives:
      Cl_p: -0.5    # Rolling moment change per roll rate (p)
      Cl_r: 0.1     # Rolling moment change per yaw rate (r)
      Cm_q: -0.8    # Pitching moment change per pitch rate (q)
      Cn_p: 0.05    # Yawing moment change per roll rate (p)
      Cn_r: -0.2    # Yawing moment change per yaw rate (r)
